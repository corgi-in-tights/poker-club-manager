{% include "events/partials/page_navigator.html" with page=page max_page=max_page %}
{% for event in events %}
  <div class="event">
    <h2>{{ event.title }}</h2>
    {% if event.description %}<p>{{ event.description }}</p>{% endif %}
    <p>Starts {{ event.start_date|date:"ha, F j, Y" }}</p>
    <p>Ends {{ event.end_date|date:"F j, Y - h:i a" }}</p>
    {% if event.is_active %}
      {% if event.is_checked_in %}
        <p>Already checked in</p>
      {% else %}
        <a href="{% url 'events:check_in' event.id %}">Check In</a>
      {% endif %}
    {% elif event.is_rsvp_open %}
      {% if not request.user.is_authenticated %}
        <span>Please log in to RSVP</span>
      {% elif event.is_rsvped %}
        <p>Already RSVPed</p>
      {% else %}
        <button class="rsvp-button"
                data-rsvp-url="{% url 'api:event-rsvp' event.id %}">RSVP</button>
      {% endif %}
    {% elif event.is_finished %}
      <span>Event has finished</span>
    {% else %}
      <span>RSVP opens on {{ event.rsvp_start_date|date:"F j, Y" }}</span>
    {% endif %}
    {% if perms.events.manage_event %}
      <a href="{% url 'events:manage' event.id %}">Manage</a>
    {% endif %}
    <a href="{% url 'events:detail' event.id %}">View Details</a>
    <button type="button"
            data-url="{% url 'events:detail' event.id %}"
            onclick="copyUrl(this)">Copy URL</button>
  </div>
{% empty %}
  <p>No events available.</p>
{% endfor %}
